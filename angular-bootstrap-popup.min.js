angular.module("ngBootstrapPopup",[]).service("$popup",function(){"use strict";var t=this,e=0;this.lng={titles:{alert:"Alert",confirm:"Confirm",prompt:"Prompt",preview:"Preview",sound:"Sound"},errors:{audio:"Your browser does not support the <code>audio</code> element.",url:"Missing url."},buttons:{ok:"Ok",close:"Close",no:"No",yes:"Yes"}},this.create=function(e,o){var n,l,s,r,i,c;return e=e?e:{},o=o?o:{},n=jQuery('<div class="modal angular-bootstrap-popup fade text-left"></div>'),l=jQuery('<div class="modal-dialog modal-'+(e.size&&"large"===e.size?"lg":"sm")+' modal-vertical-centered"></div>'),s=jQuery('<div class="modal-content"></div>'),r=jQuery('<div class="modal-header"><h4 class="modal-title"></h4></div>'),e.title&&e.title.length?1===e.title.length?r.text(e.title.toUpperCase()):r.text(e.title.charAt(0).toUpperCase()+e.title.slice(1)):e.title_html?r.html(e.title_html):r.text(t.lng.titles.alert),s.append(r),i=jQuery('<div class="modal-body"></div>'),e.content&&0<e.content.length?1===e.content.length?i.text(e.content.toUpperCase()):i.text(e.content.charAt(0).toUpperCase()+e.content.slice(1)):e.contentHTML?i.html(e.contentHTML):i.text(t.lng.titles.alert),s.append(i),e.buttons&&0<e.buttons.length&&(c=jQuery('<div class="modal-footer"></div>'),angular.forEach(e.buttons,function(t){var e=jQuery('<button type="button" class="btn btn-default"></button>');t.cls&&e.addClass(t.cls),t.text&&e.append(t.text),t.click&&(angular.isArray(t.click)||(t.click=[t.click]),e.click(function(){angular.forEach(t.click,function(t){"function"==typeof t?t():"close"===t&&n.modal("hide")})})),c.append(e)})),s.append(c),l.append(s),n.append(l),o.show=!0,n.modal(o),n.on("shown.bs.modal",function(){e.shown&&"function"==typeof e.shown&&e.shown()}).on("hidden.bs.modal",function(){n.remove(),n=null}),n},this.alert=function(e,o,n){var l={};return"object"==typeof e?(l.contentHTML="string"==typeof e.message?e.message:"",l.title="string"==typeof e.title?e.title:t.lng.titles.alert,l.buttons=[{text:t.lng.buttons.ok,click:"function"==typeof e.onclose?[e.onclose,"close"]:"close"}]):(l.contentHTML="string"==typeof e?e:"",l.title="string"==typeof o?o:t.lng.titles.alert,l.buttons=[{text:t.lng.buttons.ok,click:"function"==typeof n?[n,"close"]:"close"}]),t.create(l,{backdrop:"static",keyboard:!0})},this.confirm=function(e,o,n,l){var s={};return"object"==typeof e?(s.contentHTML="string"==typeof e.message?e.message:"",s.title="string"==typeof e.title?e.title:t.lng.titles.confirm,s.buttons=[{cls:"btn-primary",text:t.lng.buttons.yes,click:"function"==typeof e.onyes?[e.onyes,"close"]:"close"},{text:t.lng.buttons.no,click:"function"==typeof e.onno?[e.onno,"close"]:"close"}]):(s.contentHTML="string"==typeof e?e:"",s.title="string"==typeof o?o:t.lng.titles.confirm,s.buttons=[{cls:"btn-primary",text:t.lng.buttons.yes,click:"function"==typeof n?[n,"close"]:"close"},{text:t.lng.buttons.no,click:"function"==typeof l?[l,"close"]:"close"}]),t.create(s,{backdrop:"static",keyboard:!0})},this.prompt=function(o,n,l,s){++e;var r={},i="idPopupFormPrompt"+e;return"object"==typeof o?(r.val="string"==typeof o.val?o.val:"",r.placeholder="string"==typeof o.placeholder?o.placeholder:"",r.contentHTML='<input id="'+i+'" type="text" class="form-control" value="'+o.val+'" placeholder="'+r.placeholder+'" />',r.title="string"==typeof o.title?o.title:t.lng.titles.prompt,r.label="string"==typeof o.label?'<label for="'+i+'">'+o.label+"</label>":"",r.buttons=[{cls:"btn-primary",text:t.lng.buttons.ok,click:"function"==typeof o.onconfirm?[function(){o.onconfirm(jQuery("#"+i).val())},"close"]:"close"},{text:t.lng.buttons.close,click:"function"==typeof o.onabort?[o.onabort,"close"]:"close"}]):(r.contentHTML='<input id="'+i+'" type="text" class="form-control" value="'+("string"==typeof n?n:"")+'" />',r.title="string"==typeof o?o:t.lng.titles.prompt,r.label="",r.buttons=[{cls:"btn-primary",text:t.lng.buttons.ok,click:"function"==typeof l?[function(){l(jQuery("#"+i).val())},"close"]:"close"},{text:t.lng.buttons.close,click:"function"==typeof s?[s,"close"]:"close"}]),r.contentHTML='<div class="form-group">'+r.label+r.contentHTML+"</div>",r.shown=function(){jQuery("#"+i).focus().val(jQuery("#"+i).val())},t.create(r,{backdrop:"static",keyboard:!0})},this.iframe=function(e,o,n){var l={};return"object"==typeof e?(l.url="string"==typeof e.url?e.url:"",l.title="string"==typeof e.title?e.title:t.lng.titles.preview,l.size="string"==typeof e.size?e.size:"large",l.buttons=[{text:t.lng.buttons.close,click:"function"==typeof e.onclose?[e.onclose,"close"]:"close"}]):(l.url="string"==typeof e?e:"",l.title="string"==typeof o?o:t.lng.titles.preview,l.size="large",l.buttons=[{text:t.lng.buttons.close,click:"function"==typeof n?[n,"close"]:"close"}]),""===l.url?t.alert(t.lng.errors.url):(l.contentHTML='<div class="embed-responsive embed-responsive-16by9">',l.contentHTML+='<iframe class="embed-responsive-item" src="'+l.url+'" frameborder="0" allowfullscreen></iframe>',l.contentHTML+="</div>",t.create(l,{backdrop:"static",keyboard:!0}))},this.sound=function(e,o,n){function l(){document.title=i}var s,r={},i=document.title;return"object"==typeof e?(r.sources=e.sources?"string"==typeof e.sources?[e.sources]:e.sources:[],r.title="string"==typeof e.title?e.title:t.lng.titles.sound,r.size="string"==typeof e.size?e.size:"small",r.buttons=[{text:t.lng.buttons.close,click:"function"==typeof e.onclose?[e.onclose,l,"close"]:[l,"close"]}]):(r.sources="string"==typeof e?[e]:[],r.title="string"==typeof o?o:t.lng.titles.sound,r.size="small",r.buttons=[{text:t.lng.buttons.close,click:"function"==typeof n?[n,l,"close"]:[l,"close"]}]),""===r.url?s=t.alert(t.lng.errors.url):(document.title=r.title,r.contentHTML='<div class="row">',r.contentHTML+='<audio class="col-xs-12" controls>',r.contentHTML+=t.lng.errors.audio,angular.forEach(r.sources,function(t){if("string"==typeof t&&(t={url:t,type:""}),""===t.type){var e=t.url.split(".");t.type=e.length?e[e.length-1]:""}""===t.type?r.contentHTML+='<source src="'+t.url+'"/>':r.contentHTML+='<source src="'+t.url+'" type="audio/'+t.type+'" />'}),r.contentHTML+="</audio>",r.contentHTML+="</div>",s=t.create(r,{backdrop:"static",keyboard:!0}),s.find("audio")[0].onended=l,s.find("audio")[0].play()),s},this.closeAll=function(){jQuery(".modal").modal("hide"),jQuery(".modal-backdrop").remove()},this.closeAllPopups=function(){jQuery(".angular-bootstrap-popup").modal("hide")}}).directive("popupTranslate",["$popup",function(t){"use strict";return{scope:{titleAlert:"@",titleConfirm:"@",titlePrompt:"@",titlePreview:"@",titleSound:"@",buttonOk:"@",buttonClose:"@",buttonNo:"@",buttonYes:"@",errorAudio:"@",errorUrl:"@"},link:function(e){e.titleAlert&&(t.lng.titles.alert=e.titleAlert),e.titleConfirm&&(t.lng.titles.confirm=e.titleConfirm),e.titlePrompt&&(t.lng.titles.prompt=e.titlePrompt),e.titlePreview&&(t.lng.titles.preview=e.titlePreview),e.titleSound&&(t.lng.titles.sound=e.titleSound),e.buttonOk&&(t.lng.buttons.ok=e.buttonOk),e.buttonClose&&(t.lng.buttons.close=e.buttonClose),e.buttonNo&&(t.lng.buttons.no=e.buttonNo),e.buttonYes&&(t.lng.buttons.yes=e.buttonYes),e.errorAudio&&(t.lng.errors.audio=e.errorAudio),e.errorUrl&&(t.lng.errors.url=e.errorUrl)}}}]);