angular.module("ngBootstrapPopup",[]).service("$popup",function(){"use strict";var t=this,e=0;this.lng={titles:{alert:"Alert",confirm:"Confirm",prompt:"Prompt",preview:"Preview",sound:"Sound"},errors:{audio:"Your browser does not support the <code>audio</code> element.",url:"Missing url."},buttons:{ok:"Ok",close:"Close",no:"No",yes:"Yes"}},this.create=function(e,o){var n,l,s,i,r,c;return e=e?e:{},o=o?o:{},n=jQuery('<div class="modal angular-bootstrap-popup fade text-left"></div>'),l=jQuery('<div class="modal-dialog modal-'+(e.size&&"large"===e.size?"lg":"sm")+' modal-vertical-centered"></div>'),s=jQuery('<form action="#" class="modal-content"></form>'),s.on("submit",function(){return"function"==typeof e.onsubmit&&e.onsubmit(),!1}),i=jQuery('<div class="modal-header"><h4 class="modal-title"></h4></div>'),e.title&&e.title.length?1===e.title.length?i.text(e.title.toUpperCase()):i.text(e.title.charAt(0).toUpperCase()+e.title.slice(1)):e.title_html?i.html(e.title_html):i.text(t.lng.titles.alert),s.append(i),r=jQuery('<div class="modal-body"></div>'),e.content&&0<e.content.length?1===e.content.length?r.text(e.content.toUpperCase()):r.text(e.content.charAt(0).toUpperCase()+e.content.slice(1)):e.contentHTML?r.html(e.contentHTML):r.text(t.lng.titles.alert),s.append(r),e.buttons&&0<e.buttons.length&&(c=jQuery('<div class="modal-footer"></div>'),angular.forEach(e.buttons,function(t){var e=jQuery('<button type="'+(t.submit?"submit":"button")+'" class="btn btn-default"></button>');t.cls&&e.addClass(t.cls),t.text&&e.append(t.text),t.click&&(angular.isArray(t.click)||(t.click=[t.click]),e.click(function(){angular.forEach(t.click,function(t){"function"==typeof t?t():"close"===t&&n.modal("hide")})})),c.append(e)})),s.append(c),l.append(s),n.append(l),o.show=!0,n.modal(o),n.on("shown.bs.modal",function(){"function"==typeof e.shown?e.shown():s.find("button[type=submit]").focus()}).on("hidden.bs.modal",function(){n.remove(),n=null}),n},this.alert=function(e,o,n){var l={};return"object"==typeof e?(l.contentHTML="string"==typeof e.message?e.message:"",l.title="string"==typeof e.title?e.title:t.lng.titles.alert,l.buttons=[{submit:!0,text:t.lng.buttons.ok,click:"close"}],l.onsubmit="function"==typeof e.onclose?e.onclose:null):(l.contentHTML="string"==typeof e?e:"",l.title="string"==typeof o?o:t.lng.titles.alert,l.buttons=[{submit:!0,text:t.lng.buttons.ok,click:"close"}],l.onsubmit="function"==typeof n?n:null),t.create(l,{backdrop:"static",keyboard:!0})},this.confirm=function(e,o,n,l){var s={};return"object"==typeof e?(s.contentHTML="string"==typeof e.message?e.message:"",s.title="string"==typeof e.title?e.title:t.lng.titles.confirm,s.buttons=[{cls:"btn-primary",text:t.lng.buttons.yes,click:"function"==typeof e.onyes?["close",e.onyes]:"close"},{submit:!0,text:t.lng.buttons.no,click:"close"}],s.onsubmit="function"==typeof e.onno?e.onno:null):(s.contentHTML="string"==typeof e?e:"",s.title="string"==typeof o?o:t.lng.titles.confirm,s.buttons=[{cls:"btn-primary",text:t.lng.buttons.yes,click:"function"==typeof n?[n,"close"]:"close"},{submit:!0,text:t.lng.buttons.no,click:"close"}],s.onsubmit="function"==typeof l?l:null),t.create(s,{backdrop:"static",keyboard:!0})},this.prompt=function(o,n,l,s){++e;var i={},r="idPopupFormPrompt"+e;return"object"==typeof o?(i.val="string"==typeof o.val?o.val:"",i.placeholder="string"==typeof o.placeholder?o.placeholder:"",i.contentHTML='<input id="'+r+'" type="text" class="form-control" value="'+i.val+'" placeholder="'+i.placeholder+'" />',i.title="string"==typeof o.title?o.title:t.lng.titles.prompt,i.label="string"==typeof o.label?'<label for="'+r+'">'+o.label+"</label>":"",i.buttons=[{submit:!0,cls:"btn-primary",text:t.lng.buttons.ok,click:"close"},{text:t.lng.buttons.close,click:"function"==typeof o.onabort?[o.onabort,"close"]:"close"}],i.onsubmit="function"==typeof o.onconfirm?function(){o.onconfirm(jQuery("#"+r).val())}:null):(i.contentHTML='<input id="'+r+'" type="text" class="form-control" value="'+("string"==typeof n?n:"")+'" />',i.title="string"==typeof o?o:t.lng.titles.prompt,i.label="",i.buttons=[{submit:!0,cls:"btn-primary",text:t.lng.buttons.ok,click:"close"},{text:t.lng.buttons.close,click:"function"==typeof s?[s,"close"]:"close"}],i.onsubmit="function"==typeof l?function(){l(jQuery("#"+r).val())}:null),i.contentHTML='<div class="form-group">'+i.label+i.contentHTML+"</div>",i.shown=function(){jQuery("#"+r).focus().val(jQuery("#"+r).val())},t.create(i,{backdrop:"static",keyboard:!0})},this.iframe=function(e,o,n){function l(){document.title=i}var s={},i=document.title;return"object"==typeof e?(s.url="string"==typeof e.url?e.url:"",s.title="string"==typeof e.title?e.title:t.lng.titles.preview,s.size="string"==typeof e.size?e.size:"large",s.buttons=[{submit:!0,text:t.lng.buttons.close,click:[l,"close"]}],s.onsubmit="function"==typeof e.onclose?e.onclose:null):(s.url="string"==typeof e?e:"",s.title="string"==typeof o?o:t.lng.titles.preview,s.size="large",s.buttons=[{submit:!0,text:t.lng.buttons.close,click:[l,"close"]}],s.onsubmit="function"==typeof n?n:null),""===s.url?t.alert(t.lng.errors.url):(document.title=s.title,s.contentHTML='<div class="embed-responsive embed-responsive-16by9">',s.contentHTML+='<iframe class="embed-responsive-item" src="'+s.url+'" frameborder="0" allowfullscreen></iframe>',s.contentHTML+="</div>",t.create(s,{backdrop:"static",keyboard:!0}))},this.sound=function(e,o,n){function l(){document.title=r}var s,i={},r=document.title;return"object"==typeof e?(i.sources=e.sources?"string"==typeof e.sources?[e.sources]:e.sources:[],i.title="string"==typeof e.title?e.title:t.lng.titles.sound,i.size="string"==typeof e.size?e.size:"small",i.buttons=[{submit:!0,text:t.lng.buttons.close,click:[l,"close"]}],i.onsubmit="function"==typeof e.onclose?e.onclose:null):(i.sources="string"==typeof e?[e]:[],i.title="string"==typeof o?o:t.lng.titles.sound,i.size="small",i.buttons=[{submit:!0,text:t.lng.buttons.close,click:[l,"close"]}],i.onsubmit="function"==typeof n?n:null),""===i.url?s=t.alert(t.lng.errors.url):(document.title=i.title,i.contentHTML='<div class="row">',i.contentHTML+='<audio class="col-xs-12" controls>',i.contentHTML+=t.lng.errors.audio,angular.forEach(i.sources,function(t){if("string"==typeof t&&(t={url:t,type:""}),""===t.type){var e=t.url.split(".");t.type=e.length?e[e.length-1]:""}""===t.type?i.contentHTML+='<source src="'+t.url+'"/>':i.contentHTML+='<source src="'+t.url+'" type="audio/'+t.type+'" />'}),i.contentHTML+="</audio>",i.contentHTML+="</div>",s=t.create(i,{backdrop:"static",keyboard:!0}),s.find("audio")[0].onended=l,s.find("audio")[0].play()),s},this.closeAll=function(){jQuery(".modal").modal("hide"),jQuery(".modal-backdrop").remove()},this.closeAllPopups=function(){jQuery(".angular-bootstrap-popup").modal("hide")}}).directive("popupTranslate",["$popup",function(t){"use strict";return{scope:{titleAlert:"@",titleConfirm:"@",titlePrompt:"@",titlePreview:"@",titleSound:"@",buttonOk:"@",buttonClose:"@",buttonNo:"@",buttonYes:"@",errorAudio:"@",errorUrl:"@"},link:function(e){e.titleAlert&&(t.lng.titles.alert=e.titleAlert),e.titleConfirm&&(t.lng.titles.confirm=e.titleConfirm),e.titlePrompt&&(t.lng.titles.prompt=e.titlePrompt),e.titlePreview&&(t.lng.titles.preview=e.titlePreview),e.titleSound&&(t.lng.titles.sound=e.titleSound),e.buttonOk&&(t.lng.buttons.ok=e.buttonOk),e.buttonClose&&(t.lng.buttons.close=e.buttonClose),e.buttonNo&&(t.lng.buttons.no=e.buttonNo),e.buttonYes&&(t.lng.buttons.yes=e.buttonYes),e.errorAudio&&(t.lng.errors.audio=e.errorAudio),e.errorUrl&&(t.lng.errors.url=e.errorUrl)}}}]);