angular.module("ngBootstrapPopup",[]).service("$popup",function(){"use strict";function t(t){return t.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(t,e){return"".indexOf("<"+e.toLowerCase()+">")>-1?t:""})}var e=this,o=0;this.lng={titles:{alert:"Alert",confirm:"Confirm",prompt:"Prompt",preview:"Preview",sound:"Sound"},errors:{audio:"Your browser does not support the <code>audio</code> element.",url:"Missing url."},buttons:{ok:"Ok",close:"Close",no:"No",yes:"Yes"}},this.create=function(t){var o,n,r,l,i,s;if(t=t?t:{},"string"==typeof t.type)switch(t.type){case"danger":t.backgroundColor="#f2dede",t.borderColor="#ebccd1",t.textColor="#a94442";break;case"warning":t.backgroundColor="#fcf8e3",t.borderColor="#faebcc",t.textColor="#8a6d3b";break;case"info":t.backgroundColor="#d9edf7",t.borderColor="#bce8f1",t.textColor="#31708f";break;case"success":t.backgroundColor="#dff0d8",t.borderColor="#d6e9c6",t.textColor="#3c763d"}return o=jQuery('<div class="modal angular-bootstrap-popup fade text-left"></div>'),n=jQuery('<div class="modal-dialog modal-'+(t.size&&"large"===t.size?"lg":"sm")+'"></div>'),r=jQuery('<form action="#" class="modal-content"></form>'),t.borderColor&&r.css("border-color",t.borderColor),r.on("submit",function(){return"function"==typeof t.onsubmit&&t.onsubmit(),!1}),l=jQuery('<div class="modal-header"><h4 class="modal-title"></h4></div>'),t.backgroundColor&&l.css("background-color",t.backgroundColor),t.borderColor&&l.css("border-color",t.borderColor),t.textColor&&l.css("color",t.textColor),"string"==typeof t.title?l.html(t.title):l.text(e.lng.titles.alert),r.append(l),i=jQuery('<div class="modal-body"></div>'),t.content&&0<t.content.length?1===t.content.length?i.text(t.content.toUpperCase()):i.text(t.content.charAt(0).toUpperCase()+t.content.slice(1)):t.contentHTML?i.html(t.contentHTML):i.text(e.lng.titles.alert),r.append(i),t.buttons&&0<t.buttons.length&&(s=jQuery('<div class="modal-footer"></div>'),t.borderColor&&s.css("border-color",t.borderColor),angular.forEach(t.buttons,function(t){var e=jQuery('<button type="'+(t.submit?"submit":"button")+'" class="btn btn-default"></button>');t.cls&&e.addClass(t.cls),t.text&&e.append(t.text),t.click&&(angular.isArray(t.click)||(t.click=[t.click]),e.click(function(){angular.forEach(t.click,function(t){"function"==typeof t?t():"close"===t&&o.modal("hide")})})),s.append(e)})),r.append(s),n.append(r),o.append(n),o.appendTo("body").modal({keyboard:"boolean"==typeof t.keyboard?t.keyboard:!1,backdrop:"boolean"==typeof t.backdrop||"string"==typeof t.backdrop&&"static"===t.backdrop?t.backdrop:"static",show:!0}).on("shown.bs.modal",function(){if("function"==typeof interact&&"boolean"==typeof t.draggable&&t.draggable){var e,o,i=!1;l.css("cursor","move"),0<=window.navigator.userAgent.indexOf("MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")||0<=window.navigator.userAgent.indexOf("Edge/")?l.on("mouseenter",function(){i=!0}):l.on("mousedown",function(){i=!0}),interact(n[0]).draggable({max:1,restrict:{restriction:"parent",elementRect:{top:0,left:0,bottom:1,right:1}},autoScroll:!0,onmove:function(t){if(i){var e=(parseFloat(t.target.dataset.x)||0)+t.dx,o=(parseFloat(t.target.dataset.y)||0)+t.dy;t.target.style.webkitTransform=t.target.style.msTransform=t.target.style.transform="translate3D("+e+"px, "+o+"px, 0)",t.target.dataset.x=e,t.target.dataset.y=o}},onstart:function(t){e=t.target.style.transition,o=t.target.style.opacity,i&&(t.target.style.transition="0s",t.target.style.opacity="0.4")},onend:function(t){i=!1,t.target.style.transition=e,t.target.style.opacity=o,e=o=null}})}"function"==typeof interact&&"boolean"==typeof t.resizable&&t.resizable&&interact(n[0]).resizable({max:1,restrict:{restriction:"parent",elementRect:{top:0,left:0,bottom:1,right:1}},preserveAspectRatio:!1,edges:{left:!0,right:!0,bottom:!1,top:!1},invert:"reposition",onmove:function(t){t.target.style.width=t.rect.width+"px",t.target.style.height=t.rect.height+"px"},onstart:function(t){e=t.target.style.transition,o=t.target.style.opacity,t.target.style.transition="0s",t.target.style.opacity="0.4"},onend:function(t){t.target.style.transition=e,t.target.style.opacity=o,e=o=null}}),"function"==typeof t.shown?t.shown():r.find("button[type=submit]").focus()}).on("hidden.bs.modal",function(){o.remove(),o=null,"boolean"==typeof t.draggable&&t.draggable&&jQuery("html").css("cursor","")})},this.alert=function(t){return t="string"==typeof t?{message:t}:t,e.create({contentHTML:"undefined"!=typeof t.message?t.message:"",title:"string"==typeof t.title?t.title:e.lng.titles.alert,buttons:[{submit:!0,text:e.lng.buttons.ok,click:"close"}],type:"undefined"!=typeof t.type?t.type:null,backdrop:"undefined"!=typeof t.backdrop?t.backdrop:null,onsubmit:"function"==typeof t.onclose?t.onclose:null,keyboard:"undefined"!=typeof t.keyboard?t.keyboard:null,draggable:"undefined"!=typeof t.draggable?t.draggable:null,resizable:"undefined"!=typeof t.resizable?t.resizable:null})},this.confirm=function(t){return e.create({contentHTML:"undefined"!=typeof t.message?t.message:"",title:"string"==typeof t.title?t.title:e.lng.titles.confirm,buttons:[{cls:"btn-primary",text:e.lng.buttons.yes,click:"function"==typeof t.onyes?["close",t.onyes]:"close"},{submit:!0,text:e.lng.buttons.no,click:"close"}],type:"undefined"!=typeof t.type?t.type:null,backdrop:"undefined"!=typeof t.backdrop?t.backdrop:null,onsubmit:"function"==typeof t.onno?t.onno:null,keyboard:"undefined"!=typeof t.keyboard?t.keyboard:null,draggable:"undefined"!=typeof t.draggable?t.draggable:null,resizable:"undefined"!=typeof t.resizable?t.resizable:null})},this.prompt=function(t){++o;var n="idPopupFormPrompt"+o;return e.create({contentHTML:'<div class="form-group">'+("string"==typeof t.label?'<label for="'+n+'">'+t.label+"</label>":"")+'<input id="'+n+'" type="'+("string"==typeof t.fieldtype?t.fieldtype:"text")+'" class="form-control"'+("string"==typeof t.val?' value="'+t.val+'"':"")+("string"==typeof t.placeholder?' placeholder="'+t.placeholder+'"':"")+" /></div>",title:"string"==typeof t.title?t.title:e.lng.titles.prompt,buttons:[{submit:!0,cls:"btn-primary",text:e.lng.buttons.ok,click:"close"},{text:e.lng.buttons.close,click:"function"==typeof t.onabort?[t.onabort,"close"]:"close"}],type:"undefined"!=typeof t.type?t.type:null,backdrop:"undefined"!=typeof t.backdrop?t.backdrop:null,onsubmit:"function"==typeof t.onconfirm?function(){t.onconfirm(jQuery("#"+n).val())}:null,keyboard:"undefined"!=typeof t.keyboard?t.keyboard:null,draggable:"undefined"!=typeof t.draggable?t.draggable:null,resizable:"undefined"!=typeof t.resizable?t.resizable:null,shown:function(){jQuery("#"+n).focus().val(jQuery("#"+n).val())}})},this.iframe=function(o){if(o="string"==typeof o?{url:o}:o,"string"!=typeof o.url)return e.alert(e.lng.errors.url);var n,r=document.title;return document.title="string"==typeof o.title?t(o.title):e.lng.titles.preview,n="function"==typeof o.onclose?function(){document.title=r,o.onclose()}:function(){document.title=r},e.create({contentHTML:'<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="'+o.url+'" frameborder="0" allowfullscreen></iframe></div>',title:"string"==typeof o.title?o.title:e.lng.titles.preview,size:"string"==typeof o.size?o.size:"large",buttons:[{submit:!0,text:e.lng.buttons.close,click:"close"}],type:"undefined"!=typeof o.type?o.type:null,backdrop:"undefined"!=typeof o.backdrop?o.backdrop:null,onsubmit:n,keyboard:"undefined"!=typeof o.keyboard?o.keyboard:null,draggable:"undefined"!=typeof o.draggable?o.draggable:null,resizable:"undefined"!=typeof o.resizable?o.resizable:null})},this.sound=function(o){if(o="string"==typeof o?{sources:[o]}:o,o.sources){var n,r,l,i=document.title;return document.title="string"==typeof o.title?t(o.title):e.lng.titles.sound,l=function(){document.title=i,"function"==typeof o.onclose&&o.onclose()},n='<div class="row"><audio class="col-xs-12" controls>'+e.lng.errors.audio,angular.forEach(o.sources?"string"==typeof o.sources?[o.sources]:o.sources:[],function(t){if("string"==typeof t&&(t={url:t,type:""}),""===t.type){var e=t.url.split(".");t.type=e.length?e[e.length-1]:""}n+=""===t.type?'<source src="'+t.url+'"/>':'<source src="'+t.url+'" type="audio/'+t.type+'" />'}),n+="</audio></div>",r=e.create({contentHTML:n,title:"string"==typeof o.title?o.title:e.lng.titles.sound,size:"small",buttons:[{submit:!0,text:e.lng.buttons.close,click:"close"}],type:"undefined"!=typeof o.type?o.type:null,backdrop:"undefined"!=typeof o.backdrop?o.backdrop:null,onsubmit:l,keyboard:"undefined"!=typeof o.keyboard?o.keyboard:null,draggable:"undefined"!=typeof o.draggable?o.draggable:null,resizable:"undefined"!=typeof o.resizable?o.resizable:null}),r.find("audio")[0].onended=function(){l(),r.modal("hide")},r.find("audio")[0].play(),r}return e.alert(e.lng.errors.sources)},this.closeAll=function(){jQuery(".modal").modal("hide"),jQuery(".modal-backdrop").remove()},this.closeAllPopups=function(){jQuery(".angular-bootstrap-popup").modal("hide")},jQuery(document).on("show.bs.modal",".modal",function(){var t=1040+10*jQuery(".modal:visible").length;jQuery(this).css("z-index",t),setTimeout(function(){jQuery(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")},0)})}).directive("popupTranslate",["$popup",function(t){"use strict";return{scope:{titleAlert:"@",titleConfirm:"@",titlePrompt:"@",titlePreview:"@",titleSound:"@",buttonOk:"@",buttonClose:"@",buttonNo:"@",buttonYes:"@",errorAudio:"@",errorUrl:"@"},link:function(e){e.titleAlert&&(t.lng.titles.alert=e.titleAlert),e.titleConfirm&&(t.lng.titles.confirm=e.titleConfirm),e.titlePrompt&&(t.lng.titles.prompt=e.titlePrompt),e.titlePreview&&(t.lng.titles.preview=e.titlePreview),e.titleSound&&(t.lng.titles.sound=e.titleSound),e.buttonOk&&(t.lng.buttons.ok=e.buttonOk),e.buttonClose&&(t.lng.buttons.close=e.buttonClose),e.buttonNo&&(t.lng.buttons.no=e.buttonNo),e.buttonYes&&(t.lng.buttons.yes=e.buttonYes),e.errorAudio&&(t.lng.errors.audio=e.errorAudio),e.errorUrl&&(t.lng.errors.url=e.errorUrl)}}}]);