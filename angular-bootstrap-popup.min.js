angular.module("ngBootstrapPopup",[]).service("$popup",function(){"use strict";var t=this,e=0;this.lng={titles:{alert:"Alert",confirm:"Confirm",prompt:"Prompt",preview:"Preview",sound:"Sound"},buttons:{ok:"Ok",close:"Close",no:"No",yes:"Yes"}},this.create=function(e,o){var n,l,i,s,c,r;return e=e?e:{},o=o?o:{},n=jQuery('<div class="modal fade text-left"></div>'),l=jQuery('<div class="modal-dialog modal-'+(e.size&&"large"===e.size?"lg":"sm")+' modal-vertical-centered"></div>'),i=jQuery('<div class="modal-content"></div>'),s=jQuery('<div class="modal-header"><h4 class="modal-title"></h4></div>'),e.title&&e.title.length?1===e.title.length?s.text(e.title.toUpperCase()):s.text(e.title.charAt(0).toUpperCase()+e.title.slice(1)):e.title_html?s.html(e.title_html):s.text(t.lng.titles.alert),i.append(s),c=jQuery('<div class="modal-body"></div>'),e.content&&0<e.content.length?1===e.content.length?c.text(e.content.toUpperCase()):c.text(e.content.charAt(0).toUpperCase()+e.content.slice(1)):e.contentHTML?c.html(e.contentHTML):c.text(t.lng.titles.alert),i.append(c),e.buttons&&0<e.buttons.length&&(r=jQuery('<div class="modal-footer"></div>'),angular.forEach(e.buttons,function(t){var e=jQuery('<button type="button" class="btn btn-default"></button>');t.cls&&e.addClass(t.cls),t.text&&e.append(t.text),t.click&&(angular.isArray(t.click)||(t.click=[t.click]),e.click(function(){angular.forEach(t.click,function(t){"function"==typeof t?t():"close"===t&&n.modal("hide")})})),r.append(e)})),i.append(r),l.append(i),n.append(l),o.show=!0,n.modal(o),n.on("shown.bs.modal",function(){e.shown&&"function"==typeof e.shown&&e.shown()}).on("hidden.bs.modal",function(){n.remove(),n=null}),n},this.alert=function(e,o,n){return t.create({title:o?o:t.lng.titles.alert,contentHTML:e,buttons:[{text:t.lng.buttons.ok,click:"function"==typeof n?[n,"close"]:"close"}]},{backdrop:"static",keyboard:!0})},this.confirm=function(e,o,n,l){return t.create({title:o?o:t.lng.titles.confirm,contentHTML:e,buttons:[{cls:"btn-primary",text:t.lng.buttons.yes,click:"function"==typeof n?[n,"close"]:"close"},{text:t.lng.buttons.no,click:"function"==typeof l?[l,"close"]:"close"}]},{backdrop:"static",keyboard:!0})},this.prompt=function(o,n,l,i){o=o?o:t.lng.titles.prompt,++e;var s="idPopupFormPrompt"+e,c="";return c=n?'<input id="'+s+'" type="text" class="form-control" value="'+n+'" />':'<input id="'+s+'" type="text" class="form-control" />',t.create({title:o,contentHTML:'<div class="form-group"><label for="'+s+'">'+o+"</label>"+c+"</div>",buttons:[{cls:"btn-primary",text:t.lng.buttons.ok,click:"function"==typeof l?[function(){l(jQuery("#"+s).val())},"close"]:"close"},{text:t.lng.buttons.close,click:"function"==typeof i?[i,"close"]:"close"}],shown:function(){jQuery("#"+s).focus()}},{backdrop:"static",keyboard:!0})},this.iframe=function(e,o){return t.create({title:o?o:t.lng.titles.preview,contentHTML:'<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="'+e+'" frameborder="0" allowfullscreen></iframe></div>',size:"large",buttons:[{text:t.lng.buttons.close,click:"close"}]},{backdrop:"static",keyboard:!0})},this.sound=function(e,o){function n(){l.modal("hide"),document.title=i}var l,i=document.title;return document.title=o,l=t.create({title:o?o:t.lng.titles.sound,contentHTML:'<div class="row"><audio class="col-xs-12" controls>Votre navigateur ne supporte pas l\'Ã©lÃ©ment <code>audio</code>.<source src="'+e+'" type="audio/wav"></audio></div>',size:"large",buttons:[{text:t.lng.buttons.close,click:n}]},{backdrop:"static",keyboard:!0}),l.find("audio")[0].onended=n,l.find("audio")[0].play(),l},this.closeAll=function(){jQuery(".modal").modal("hide"),jQuery(".modal-backdrop").remove()}}).directive("popupTranslate",["$popup",function(t){"use strict";return{scope:{titleAlert:"@",titleConfirm:"@",titlePrompt:"@",titlePreview:"@",titleSound:"@",buttonOk:"@",buttonClose:"@",buttonNo:"@",buttonYes:"@"},link:function(e){e.titleAlert&&(t.lng.titles.alert=e.titleAlert),e.titleConfirm&&(t.lng.titles.confirm=e.titleConfirm),e.titlePrompt&&(t.lng.titles.prompt=e.titlePrompt),e.titlePreview&&(t.lng.titles.preview=e.titlePreview),e.titleSound&&(t.lng.titles.sound=e.titleSound),e.buttonOk&&(t.lng.buttons.ok=e.buttonOk),e.buttonClose&&(t.lng.buttons.close=e.buttonClose),e.buttonNo&&(t.lng.buttons.no=e.buttonNo),e.buttonYes&&(t.lng.buttons.yes=e.buttonYes)}}}]);