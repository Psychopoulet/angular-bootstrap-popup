angular.module("ngBootstrapPopup",[]).service("$popup",function(){"use strict";var t=this,e=0;this.lng={titles:{alert:"Alert",confirm:"Confirm",prompt:"Prompt",preview:"Preview",sound:"Sound"},errors:{audio:"Your browser does not support the <code>audio</code> element.",url:"Missing url."},buttons:{ok:"Ok",close:"Close",no:"No",yes:"Yes"}},this.create=function(e){var o,n,r,l,i,s;if(e=e?e:{},"string"==typeof e.type)switch(e.type){case"danger":e.backgroundColor="#f2dede",e.borderColor="#ebccd1",e.textColor="#a94442";break;case"warning":e.backgroundColor="#fcf8e3",e.borderColor="#faebcc",e.textColor="#8a6d3b";break;case"info":e.backgroundColor="#d9edf7",e.borderColor="#bce8f1",e.textColor="#31708f";break;case"success":e.backgroundColor="#dff0d8",e.borderColor="#d6e9c6",e.textColor="#3c763d"}return o=jQuery('<div class="modal angular-bootstrap-popup fade text-left"></div>'),n=jQuery('<div class="modal-dialog modal-'+(e.size&&"large"===e.size?"lg":"sm")+'"></div>'),r=jQuery('<form action="#" class="modal-content"></form>'),e.borderColor&&r.css("border-color",e.borderColor),r.on("submit",function(){return"function"==typeof e.onsubmit&&e.onsubmit(),!1}),l=jQuery('<div class="modal-header"><h4 class="modal-title"></h4></div>'),e.backgroundColor&&l.css("background-color",e.backgroundColor),e.borderColor&&l.css("border-color",e.borderColor),e.textColor&&l.css("color",e.textColor),e.title&&e.title.length?1===e.title.length?l.text(e.title.toUpperCase()):l.text(e.title.charAt(0).toUpperCase()+e.title.slice(1)):e.title_html?l.html(e.title_html):l.text(t.lng.titles.alert),r.append(l),i=jQuery('<div class="modal-body"></div>'),e.content&&0<e.content.length?1===e.content.length?i.text(e.content.toUpperCase()):i.text(e.content.charAt(0).toUpperCase()+e.content.slice(1)):e.contentHTML?i.html(e.contentHTML):i.text(t.lng.titles.alert),r.append(i),e.buttons&&0<e.buttons.length&&(s=jQuery('<div class="modal-footer"></div>'),e.borderColor&&s.css("border-color",e.borderColor),angular.forEach(e.buttons,function(t){var e=jQuery('<button type="'+(t.submit?"submit":"button")+'" class="btn btn-default"></button>');t.cls&&e.addClass(t.cls),t.text&&e.append(t.text),t.click&&(angular.isArray(t.click)||(t.click=[t.click]),e.click(function(){angular.forEach(t.click,function(t){"function"==typeof t?t():"close"===t&&o.modal("hide")})})),s.append(e)})),r.append(s),n.append(r),o.append(n),o.appendTo("body").modal({keyboard:"boolean"==typeof e.keyboard?e.keyboard:!1,backdrop:"boolean"==typeof e.backdrop||"string"==typeof e.backdrop&&"static"===e.backdrop?e.backdrop:"static",show:!0}).on("shown.bs.modal",function(){if("function"==typeof interact&&"boolean"==typeof e.draggable&&e.draggable){var t,o,i=!1;l.css("cursor","move"),0<=window.navigator.userAgent.indexOf("MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")||0<=window.navigator.userAgent.indexOf("Edge/")?l.on("mouseenter",function(){i=!0}):l.on("mousedown",function(){i=!0}),interact(n[0]).draggable({max:1,restrict:{restriction:"parent",elementRect:{top:0,left:0,bottom:1,right:1}},autoScroll:!0,onmove:function(t){if(i){var e=(parseFloat(t.target.dataset.x)||0)+t.dx,o=(parseFloat(t.target.dataset.y)||0)+t.dy;t.target.style.webkitTransform=t.target.style.msTransform=t.target.style.transform="translate3D("+e+"px, "+o+"px, 0)",t.target.dataset.x=e,t.target.dataset.y=o}},onstart:function(e){t=e.target.style.transition,o=e.target.style.opacity,i&&(e.target.style.transition="0s",e.target.style.opacity="0.4")},onend:function(e){i=!1,e.target.style.transition=t,e.target.style.opacity=o,t=o=null}})}"function"==typeof interact&&"boolean"==typeof e.resizable&&e.resizable&&interact(n[0]).resizable({max:1,restrict:{restriction:"parent",elementRect:{top:0,left:0,bottom:1,right:1}},preserveAspectRatio:!1,edges:{left:!0,right:!0,bottom:!1,top:!1},invert:"reposition",onmove:function(t){t.target.style.width=t.rect.width+"px",t.target.style.height=t.rect.height+"px"},onstart:function(e){t=e.target.style.transition,o=e.target.style.opacity,e.target.style.transition="0s",e.target.style.opacity="0.4"},onend:function(e){e.target.style.transition=t,e.target.style.opacity=o,t=o=null}}),"function"==typeof e.shown?e.shown():r.find("button[type=submit]").focus()}).on("hidden.bs.modal",function(){o.remove(),o=null,"boolean"==typeof e.draggable&&e.draggable&&jQuery("html").css("cursor","")})},this.alert=function(e){return e="string"==typeof e?{message:e}:e,t.create({contentHTML:"undefined"!=typeof e.message?e.message:"",title:"string"==typeof e.title?e.title:t.lng.titles.alert,buttons:[{submit:!0,text:t.lng.buttons.ok,click:"close"}],type:"undefined"!=typeof e.type?e.type:null,backdrop:"undefined"!=typeof e.backdrop?e.backdrop:null,onsubmit:"function"==typeof e.onclose?e.onclose:null,keyboard:"undefined"!=typeof e.keyboard?e.keyboard:null,draggable:"undefined"!=typeof e.draggable?e.draggable:null,resizable:"undefined"!=typeof e.resizable?e.resizable:null})},this.confirm=function(e){return t.create({contentHTML:"undefined"!=typeof e.message?e.message:"",title:"string"==typeof e.title?e.title:t.lng.titles.confirm,buttons:[{cls:"btn-primary",text:t.lng.buttons.yes,click:"function"==typeof e.onyes?["close",e.onyes]:"close"},{submit:!0,text:t.lng.buttons.no,click:"close"}],type:"undefined"!=typeof e.type?e.type:null,backdrop:"undefined"!=typeof e.backdrop?e.backdrop:null,onsubmit:"function"==typeof e.onno?e.onno:null,keyboard:"undefined"!=typeof e.keyboard?e.keyboard:null,draggable:"undefined"!=typeof e.draggable?e.draggable:null,resizable:"undefined"!=typeof e.resizable?e.resizable:null})},this.prompt=function(o){++e;var n="idPopupFormPrompt"+e;return t.create({contentHTML:'<div class="form-group">'+("string"==typeof o.label?'<label for="'+n+'">'+o.label+"</label>":"")+'<input id="'+n+'" type="text" class="form-control"'+("string"==typeof o.val?' value="'+o.val+'"':"")+("string"==typeof o.placeholder?' placeholder="'+o.placeholder+'"':"")+" /></div>",title:"string"==typeof o.title?o.title:t.lng.titles.prompt,buttons:[{submit:!0,cls:"btn-primary",text:t.lng.buttons.ok,click:"close"},{text:t.lng.buttons.close,click:"function"==typeof o.onabort?[o.onabort,"close"]:"close"}],type:"undefined"!=typeof o.type?o.type:null,backdrop:"undefined"!=typeof o.backdrop?o.backdrop:null,onsubmit:"function"==typeof o.onconfirm?function(){o.onconfirm(jQuery("#"+n).val())}:null,keyboard:"undefined"!=typeof o.keyboard?o.keyboard:null,draggable:"undefined"!=typeof o.draggable?o.draggable:null,resizable:"undefined"!=typeof o.resizable?o.resizable:null,shown:function(){jQuery("#"+n).focus().val(jQuery("#"+n).val())}})},this.iframe=function(e){function o(){document.title=n}var n=document.title;return e="string"==typeof e?{url:e}:e,"string"!=typeof e.url?t.alert(t.lng.errors.url):(document.title="string"==typeof e.title?jQuery(e.title).text():t.lng.titles.preview,t.create({contentHTML:'<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="'+e.url+'" frameborder="0" allowfullscreen></iframe></div>',title:"string"==typeof e.title?e.title:t.lng.titles.preview,size:"string"==typeof e.size?e.size:"large",buttons:[{submit:!0,text:t.lng.buttons.close,click:"close"}],type:"undefined"!=typeof e.type?e.type:null,backdrop:"undefined"!=typeof e.backdrop?e.backdrop:null,onsubmit:"function"==typeof e.onclose?function(){o(),e.onclose()}:o,keyboard:"undefined"!=typeof e.keyboard?e.keyboard:null,draggable:"undefined"!=typeof e.draggable?e.draggable:null,resizable:"undefined"!=typeof e.resizable?e.resizable:null}))},this.sound=function(e){function o(){document.title=n}var n=document.title;if(e="string"==typeof e?{sources:[e]}:e,e.sources){var r,l;return document.title="string"==typeof e.title?jQuery(e.title).text():t.lng.titles.sound,r='<div class="row"><audio class="col-xs-12" controls>'+t.lng.errors.audio,angular.forEach(e.sources?"string"==typeof e.sources?[e.sources]:e.sources:[],function(t){if("string"==typeof t&&(t={url:t,type:""}),""===t.type){var e=t.url.split(".");t.type=e.length?e[e.length-1]:""}r+=""===t.type?'<source src="'+t.url+'"/>':'<source src="'+t.url+'" type="audio/'+t.type+'" />'}),r+="</audio></div>",l=t.create({contentHTML:r,title:document.title,size:"small",buttons:[{submit:!0,text:t.lng.buttons.close,click:"close"}],type:"undefined"!=typeof e.type?e.type:null,backdrop:"undefined"!=typeof e.backdrop?e.backdrop:null,onsubmit:"function"==typeof e.onclose?function(){o(),e.onclose()}:o,keyboard:"undefined"!=typeof e.keyboard?e.keyboard:null,draggable:"undefined"!=typeof e.draggable?e.draggable:null,resizable:"undefined"!=typeof e.resizable?e.resizable:null}),l.find("audio")[0].onended=o,l.find("audio")[0].play(),l}return t.alert(t.lng.errors.sources)},this.closeAll=function(){jQuery(".modal").modal("hide"),jQuery(".modal-backdrop").remove()},this.closeAllPopups=function(){jQuery(".angular-bootstrap-popup").modal("hide")},jQuery(document).on("show.bs.modal",".modal",function(){var t=1040+10*jQuery(".modal:visible").length;jQuery(this).css("z-index",t),setTimeout(function(){jQuery(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")},0)})}).directive("popupTranslate",["$popup",function(t){"use strict";return{scope:{titleAlert:"@",titleConfirm:"@",titlePrompt:"@",titlePreview:"@",titleSound:"@",buttonOk:"@",buttonClose:"@",buttonNo:"@",buttonYes:"@",errorAudio:"@",errorUrl:"@"},link:function(e){e.titleAlert&&(t.lng.titles.alert=e.titleAlert),e.titleConfirm&&(t.lng.titles.confirm=e.titleConfirm),e.titlePrompt&&(t.lng.titles.prompt=e.titlePrompt),e.titlePreview&&(t.lng.titles.preview=e.titlePreview),e.titleSound&&(t.lng.titles.sound=e.titleSound),e.buttonOk&&(t.lng.buttons.ok=e.buttonOk),e.buttonClose&&(t.lng.buttons.close=e.buttonClose),e.buttonNo&&(t.lng.buttons.no=e.buttonNo),e.buttonYes&&(t.lng.buttons.yes=e.buttonYes),e.errorAudio&&(t.lng.errors.audio=e.errorAudio),e.errorUrl&&(t.lng.errors.url=e.errorUrl)}}}]);