angular.module("ngBootstrapPopup",[]).service("$popup",["$timeout",function(t){"use strict";var e=this,o=0;this.lng={titles:{alert:"Alert",confirm:"Confirm",prompt:"Prompt",preview:"Preview",sound:"Sound"},errors:{audio:"Your browser does not support the <code>audio</code> element.",url:"Missing url."},buttons:{ok:"Ok",close:"Close",no:"No",yes:"Yes"}},this.create=function(t,o){var n,r,l,s,i,c;if(t=t?t:{},o=o?o:{},t.type)switch(t.type){case"danger":t.backgroundColor="#f2dede",t.borderColor="#ebccd1",t.textColor="#a94442";break;case"warning":t.backgroundColor="#fcf8e3",t.borderColor="#faebcc",t.textColor="#8a6d3b";break;case"info":t.backgroundColor="#d9edf7",t.borderColor="#bce8f1",t.textColor="#31708f";break;case"success":t.backgroundColor="#dff0d8",t.borderColor="#d6e9c6",t.textColor="#3c763d"}return n=jQuery('<div class="modal angular-bootstrap-popup fade text-left"></div>'),r=jQuery('<div class="modal-dialog modal-'+(t.size&&"large"===t.size?"lg":"sm")+' modal-vertical-centered"></div>'),l=jQuery('<form action="#" class="modal-content"></form>'),t.borderColor&&l.css("border-color",t.borderColor),l.on("submit",function(){return"function"==typeof t.onsubmit&&t.onsubmit(),!1}),s=jQuery('<div class="modal-header"><h4 class="modal-title"></h4></div>'),t.backgroundColor&&s.css("background-color",t.backgroundColor),t.borderColor&&s.css("border-color",t.borderColor),t.textColor&&s.css("color",t.textColor),t.title&&t.title.length?1===t.title.length?s.text(t.title.toUpperCase()):s.text(t.title.charAt(0).toUpperCase()+t.title.slice(1)):t.title_html?s.html(t.title_html):s.text(e.lng.titles.alert),l.append(s),i=jQuery('<div class="modal-body"></div>'),t.content&&0<t.content.length?1===t.content.length?i.text(t.content.toUpperCase()):i.text(t.content.charAt(0).toUpperCase()+t.content.slice(1)):t.contentHTML?i.html(t.contentHTML):i.text(e.lng.titles.alert),l.append(i),t.buttons&&0<t.buttons.length&&(c=jQuery('<div class="modal-footer"></div>'),t.borderColor&&c.css("border-color",t.borderColor),angular.forEach(t.buttons,function(t){var e=jQuery('<button type="'+(t.submit?"submit":"button")+'" class="btn btn-default"></button>');t.cls&&e.addClass(t.cls),t.text&&e.append(t.text),t.click&&(angular.isArray(t.click)||(t.click=[t.click]),e.click(function(){angular.forEach(t.click,function(t){"function"==typeof t?t():"close"===t&&n.modal("hide")})})),c.append(e)})),l.append(c),r.append(l),n.append(r),o.show=!0,n.modal(o),n.on("shown.bs.modal",function(){if("function"==typeof interact){var e,o,n=!1;s.css("cursor","move").on("mousedown",function(){n=!0}).on("mouseenter",function(){n=!0}),interact(r[0]).draggable({inertia:!1,restrict:{restriction:"parent",endOnly:!0,elementRect:{top:0,left:0,bottom:1,right:1}},autoScroll:!0,onmove:function(t){if(n){var e=(parseFloat(t.target.dataset.x)||0)+t.dx,o=(parseFloat(t.target.dataset.y)||0)+t.dy;t.target.style.webkitTransform=t.target.style.transform="translate3D("+e+"px, "+o+"px, 0)",t.target.dataset.x=e,t.target.dataset.y=o}}}).on("dragstart",function(t){e=t.target.style.transition,o=t.target.style.opacity,n&&(t.target.style.transition="0s",t.target.style.opacity="0.4")}).on("dragend",function(t){n=!1,t.target.style.transition=e,t.target.style.opacity=o})}"function"==typeof t.shown?t.shown():l.find("button[type=submit]").focus()}).on("hidden.bs.modal",function(){n.remove(),n=null}),n},this.alert=function(t){return t="string"==typeof t?{message:t}:t,e.create({contentHTML:"string"==typeof t.message?t.message:"",title:"string"==typeof t.title?t.title:e.lng.titles.alert,buttons:[{submit:!0,text:e.lng.buttons.ok,click:"close"}],type:"string"==typeof t.type?t.type:null,onsubmit:"function"==typeof t.onclose?t.onclose:null},{backdrop:"static",keyboard:!0})},this.confirm=function(t){return e.create({contentHTML:"string"==typeof t.message?t.message:"",title:"string"==typeof t.title?t.title:e.lng.titles.confirm,buttons:[{cls:"btn-primary",text:e.lng.buttons.yes,click:"function"==typeof t.onyes?["close",t.onyes]:"close"},{submit:!0,text:e.lng.buttons.no,click:"close"}],type:"string"==typeof t.type?t.type:null,onsubmit:"function"==typeof t.onno?t.onno:null},{backdrop:"static",keyboard:!1})},this.prompt=function(t){++o;var n="idPopupFormPrompt"+o;return e.create({contentHTML:'<div class="form-group">'+("string"==typeof t.label?'<label for="'+n+'">'+t.label+"</label>":"")+'<input id="'+n+'" type="text" class="form-control"'+("string"==typeof t.val?' value="'+t.val+'"':"")+("string"==typeof t.placeholder?' placeholder="'+t.placeholder+'"':"")+" /></div>",title:"string"==typeof t.title?t.title:e.lng.titles.prompt,buttons:[{submit:!0,cls:"btn-primary",text:e.lng.buttons.ok,click:"close"},{text:e.lng.buttons.close,click:"function"==typeof t.onabort?[t.onabort,"close"]:"close"}],onsubmit:"function"==typeof t.onconfirm?function(){t.onconfirm(jQuery("#"+n).val())}:null,shown:function(){jQuery("#"+n).focus().val(jQuery("#"+n).val())}},{backdrop:"static",keyboard:!1})},this.iframe=function(t){function o(){document.title=n}var n=document.title;return t="string"==typeof t?{url:t}:t,t.url?(document.title="string"==typeof t.title?t.title:e.lng.titles.preview,e.create({contentHTML:'<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="'+t.url+'" frameborder="0" allowfullscreen></iframe></div>',title:document.title,size:"string"==typeof t.size?t.size:"large",buttons:[{submit:!0,text:e.lng.buttons.close,click:"close"}],onsubmit:"function"==typeof t.onclose?function(){o(),t.onclose()}:o},{backdrop:"static",keyboard:!0})):e.alert(e.lng.errors.url)},this.sound=function(t){function o(){document.title=n}var n=document.title;if(t="string"==typeof t?{sources:[t]}:t,t.sources){var r,l;return document.title="string"==typeof t.title?t.title:e.lng.titles.sound,r='<div class="row"><audio class="col-xs-12" controls>'+e.lng.errors.audio,angular.forEach(t.sources?"string"==typeof t.sources?[t.sources]:t.sources:[],function(t){if("string"==typeof t&&(t={url:t,type:""}),""===t.type){var e=t.url.split(".");t.type=e.length?e[e.length-1]:""}r+=""===t.type?'<source src="'+t.url+'"/>':'<source src="'+t.url+'" type="audio/'+t.type+'" />'}),r+="</audio></div>",l=e.create({contentHTML:r,title:document.title,size:"small",buttons:[{submit:!0,text:e.lng.buttons.close,click:"close"}],onsubmit:"function"==typeof t.onclose?function(){o(),t.onclose()}:o},{backdrop:"static",keyboard:!0}),l.find("audio")[0].onended=o,l.find("audio")[0].play(),l}return e.alert(e.lng.errors.sources)},this.closeAll=function(){jQuery(".modal").modal("hide"),jQuery(".modal-backdrop").remove()},this.closeAllPopups=function(){jQuery(".angular-bootstrap-popup").modal("hide")}}]).directive("popupTranslate",["$popup",function(t){"use strict";return{scope:{titleAlert:"@",titleConfirm:"@",titlePrompt:"@",titlePreview:"@",titleSound:"@",buttonOk:"@",buttonClose:"@",buttonNo:"@",buttonYes:"@",errorAudio:"@",errorUrl:"@"},link:function(e){e.titleAlert&&(t.lng.titles.alert=e.titleAlert),e.titleConfirm&&(t.lng.titles.confirm=e.titleConfirm),e.titlePrompt&&(t.lng.titles.prompt=e.titlePrompt),e.titlePreview&&(t.lng.titles.preview=e.titlePreview),e.titleSound&&(t.lng.titles.sound=e.titleSound),e.buttonOk&&(t.lng.buttons.ok=e.buttonOk),e.buttonClose&&(t.lng.buttons.close=e.buttonClose),e.buttonNo&&(t.lng.buttons.no=e.buttonNo),e.buttonYes&&(t.lng.buttons.yes=e.buttonYes),e.errorAudio&&(t.lng.errors.audio=e.errorAudio),e.errorUrl&&(t.lng.errors.url=e.errorUrl)}}}]);