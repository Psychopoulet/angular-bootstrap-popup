angular.module("ngBootstrapPopup",[]).service("$popup",function(){"use strict";var t=this,o=0;this.lng={titles:{alert:"Alert",confirm:"Confirm",prompt:"Prompt",preview:"Preview",sound:"Sound"},errors:{audio:"Your browser does not support the <code>audio</code> element.",url:"Missing url."},buttons:{ok:"Ok",close:"Close",no:"No",yes:"Yes"}},this.create=function(o,e){var n,r,l,s,i,c;if(o=o?o:{},e=e?e:{},o.type)switch(o.type){case"danger":o.backgroundColor="#f2dede",o.borderColor="#ebccd1",o.textColor="#a94442";break;case"warning":o.backgroundColor="#fcf8e3",o.borderColor="#faebcc",o.textColor="#8a6d3b";break;case"info":o.backgroundColor="#d9edf7",o.borderColor="#bce8f1",o.textColor="#31708f";break;case"success":o.backgroundColor="#dff0d8",o.borderColor="#d6e9c6",o.textColor="#3c763d"}return n=jQuery('<div class="modal angular-bootstrap-popup fade text-left"></div>'),r=jQuery('<div class="modal-dialog modal-'+(o.size&&"large"===o.size?"lg":"sm")+' modal-vertical-centered"></div>'),l=jQuery('<form action="#" class="modal-content"></form>'),o.borderColor&&l.css("border-color",o.borderColor),l.on("submit",function(){return"function"==typeof o.onsubmit&&o.onsubmit(),!1}),s=jQuery('<div class="modal-header"><h4 class="modal-title"></h4></div>'),o.backgroundColor&&s.css("background-color",o.backgroundColor),o.borderColor&&s.css("border-color",o.borderColor),o.textColor&&s.css("color",o.textColor),o.title&&o.title.length?1===o.title.length?s.text(o.title.toUpperCase()):s.text(o.title.charAt(0).toUpperCase()+o.title.slice(1)):o.title_html?s.html(o.title_html):s.text(t.lng.titles.alert),l.append(s),i=jQuery('<div class="modal-body"></div>'),o.content&&0<o.content.length?1===o.content.length?i.text(o.content.toUpperCase()):i.text(o.content.charAt(0).toUpperCase()+o.content.slice(1)):o.contentHTML?i.html(o.contentHTML):i.text(t.lng.titles.alert),l.append(i),o.buttons&&0<o.buttons.length&&(c=jQuery('<div class="modal-footer"></div>'),o.borderColor&&c.css("border-color",o.borderColor),angular.forEach(o.buttons,function(t){var o=jQuery('<button type="'+(t.submit?"submit":"button")+'" class="btn btn-default"></button>');t.cls&&o.addClass(t.cls),t.text&&o.append(t.text),t.click&&(angular.isArray(t.click)||(t.click=[t.click]),o.click(function(){angular.forEach(t.click,function(t){"function"==typeof t?t():"close"===t&&n.modal("hide")})})),c.append(o)})),l.append(c),r.append(l),n.append(r),e.show=!0,n.modal(e),n.on("shown.bs.modal",function(){"function"==typeof o.shown?o.shown():l.find("button[type=submit]").focus()}).on("hidden.bs.modal",function(){n.remove(),n=null}),n},this.alert=function(o){return o="string"==typeof o?{message:o}:o,t.create({contentHTML:"string"==typeof o.message?o.message:"",title:"string"==typeof o.title?o.title:t.lng.titles.alert,buttons:[{submit:!0,text:t.lng.buttons.ok,click:"close"}],type:"string"==typeof o.type?o.type:null,onsubmit:"function"==typeof o.onclose?o.onclose:null},{backdrop:"static",keyboard:!0})},this.confirm=function(o){return t.create({contentHTML:"string"==typeof o.message?o.message:"",title:"string"==typeof o.title?o.title:t.lng.titles.confirm,buttons:[{cls:"btn-primary",text:t.lng.buttons.yes,click:"function"==typeof o.onyes?["close",o.onyes]:"close"},{submit:!0,text:t.lng.buttons.no,click:"close"}],type:"string"==typeof o.type?o.type:null,onsubmit:"function"==typeof o.onno?o.onno:null},{backdrop:"static",keyboard:!1})},this.prompt=function(e){++o;var n="idPopupFormPrompt"+o;return t.create({contentHTML:'<div class="form-group">'+("string"==typeof e.label?'<label for="'+n+'">'+e.label+"</label>":"")+'<input id="'+n+'" type="text" class="form-control"'+("string"==typeof e.val?' value="'+e.val+'"':"")+("string"==typeof e.placeholder?' placeholder="'+e.placeholder+'"':"")+" /></div>",title:"string"==typeof e.title?e.title:t.lng.titles.prompt,buttons:[{submit:!0,cls:"btn-primary",text:t.lng.buttons.ok,click:"close"},{text:t.lng.buttons.close,click:"function"==typeof e.onabort?[e.onabort,"close"]:"close"}],onsubmit:"function"==typeof e.onconfirm?function(){e.onconfirm(jQuery("#"+n).val())}:null,shown:function(){jQuery("#"+n).focus().val(jQuery("#"+n).val())}},{backdrop:"static",keyboard:!1})},this.iframe=function(o){function e(){document.title=n}if(o="string"==typeof o?{url:o}:o,o.url){var n=document.title;return document.title="string"==typeof o.title?o.title:t.lng.titles.preview,t.create({contentHTML:'<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="'+o.url+'" frameborder="0" allowfullscreen></iframe></div>',title:document.title,size:"string"==typeof o.size?o.size:"large",buttons:[{submit:!0,text:t.lng.buttons.close,click:"close"}],onsubmit:"function"==typeof o.onclose?function(){e(),o.onclose()}:e},{backdrop:"static",keyboard:!0})}return t.alert(t.lng.errors.url)},this.sound=function(o){function e(){document.title=l}if(o="string"==typeof o?{sources:[o]}:o,o.sources){var n,r,l=document.title;return document.title="string"==typeof o.title?o.title:t.lng.titles.sound,n='<div class="row"><audio class="col-xs-12" controls>'+t.lng.errors.audio,angular.forEach(o.sources?"string"==typeof o.sources?[o.sources]:o.sources:[],function(t){if("string"==typeof t&&(t={url:t,type:""}),""===t.type){var o=t.url.split(".");t.type=o.length?o[o.length-1]:""}n+=""===t.type?'<source src="'+t.url+'"/>':'<source src="'+t.url+'" type="audio/'+t.type+'" />'}),n+="</audio></div>",r=t.create({contentHTML:n,title:document.title,size:"small",buttons:[{submit:!0,text:t.lng.buttons.close,click:"close"}],onsubmit:"function"==typeof o.onclose?function(){e(),o.onclose()}:e},{backdrop:"static",keyboard:!0}),r.find("audio")[0].onended=e,r.find("audio")[0].play(),r}return t.alert(t.lng.errors.sources)},this.closeAll=function(){jQuery(".modal").modal("hide"),jQuery(".modal-backdrop").remove()},this.closeAllPopups=function(){jQuery(".angular-bootstrap-popup").modal("hide")}}).directive("popupTranslate",["$popup",function(t){"use strict";return{scope:{titleAlert:"@",titleConfirm:"@",titlePrompt:"@",titlePreview:"@",titleSound:"@",buttonOk:"@",buttonClose:"@",buttonNo:"@",buttonYes:"@",errorAudio:"@",errorUrl:"@"},link:function(o){o.titleAlert&&(t.lng.titles.alert=o.titleAlert),o.titleConfirm&&(t.lng.titles.confirm=o.titleConfirm),o.titlePrompt&&(t.lng.titles.prompt=o.titlePrompt),o.titlePreview&&(t.lng.titles.preview=o.titlePreview),o.titleSound&&(t.lng.titles.sound=o.titleSound),o.buttonOk&&(t.lng.buttons.ok=o.buttonOk),o.buttonClose&&(t.lng.buttons.close=o.buttonClose),o.buttonNo&&(t.lng.buttons.no=o.buttonNo),o.buttonYes&&(t.lng.buttons.yes=o.buttonYes),o.errorAudio&&(t.lng.errors.audio=o.errorAudio),o.errorUrl&&(t.lng.errors.url=o.errorUrl)}}}]);